<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>5S Spiel ‚Äì Stufen 0‚Äì4</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { font-family: Arial, sans-serif; text-align: center; background: #f5f5f5; margin: 0; padding: 20px; }
  h1 { margin-bottom: 10px; }
  #grid {
    display: grid;
    gap: 6px;
    justify-content: center;
    max-width: 500px;
    margin: 20px auto;
  }
  button {
    width: 12vw; height: 12vw; max-width: 70px; max-height: 70px;
    font-size: 3vw; border: 1px solid #aaa; border-radius: 8px;
    cursor: pointer; background: white; touch-action: manipulation;
  }
  #controls { margin: 10px auto; }
  #info { margin-top: 10px; padding: 8px; background: #e0e0e0; border-radius: 6px; width: 80%; margin-left:auto; margin-right:auto; }
  #result { font-weight: bold; margin-top: 15px; }
  #nextStage, #cleanBtn, #sortBtn { padding: 8px 16px; font-size: 16px; margin-top: 10px; cursor: pointer; display: none; }
  #grid.stage2 { grid-template-columns: repeat(9, 1fr); }
</style>
</head>
<body>

<h1>5S Trainingsspiel ‚Äì Stufen 0‚Äì4</h1>
<h2 id="stageTitle">Stufe 0 ‚Äì Farbenchaos</h2>
<p id="info">Klicke die Zahlen 1 bis 64 in richtiger Reihenfolge.</p>
<p>Zeit: <span id="timer">0.0</span> s</p>

<div id="grid"></div>

<div id="controls">
  <button id="cleanBtn">üßπ S√§ubern</button>
  <button id="sortBtn">üî¢ Ordnen</button>
  <button id="nextStage">‚û°Ô∏è Weiter</button>
</div>

<p id="result"></p>

<script>
const grid = document.getElementById("grid");
const timerDisplay = document.getElementById("timer");
const result = document.getElementById("result");
const nextBtn = document.getElementById("nextStage");
const cleanBtn = document.getElementById("cleanBtn");
const sortBtn = document.getElementById("sortBtn");
const stageTitle = document.getElementById("stageTitle");
const info = document.getElementById("info");

let stage = 0;
let startTime, timer;

function startTimer() { startTime = Date.now(); timer = setInterval(() => { timerDisplay.textContent = ((Date.now()-startTime)/1000).toFixed(1); },100); }
function stopTimer() { clearInterval(timer); }
function shuffle(arr) { return arr.sort(()=>Math.random()-0.5); }
function randomColor() { return "hsl("+Math.floor(Math.random()*360)+",80%,40%)"; }

function createButtons(numbers, onClickFunc) {
  grid.innerHTML = "";
  numbers.forEach(n => {
    const b = document.createElement("button");
    b.textContent = n;
    b.style.color = randomColor();
    b.onclick = () => onClickFunc(n,b);
    grid.appendChild(b);
  });
}

// ---------- STUFE 0 ----------
function stage0() {
  stageTitle.textContent="Stufe 0 ‚Äì Farbenchaos";
  info.textContent="Klicke die Zahlen 1‚Äì64 in richtiger Reihenfolge.";
  grid.className = "";
  result.textContent=""; timerDisplay.textContent="0.0";
  nextBtn.style.display="none"; cleanBtn.style.display="none"; sortBtn.style.display="none";
  startTime=null;

  let numbers = shuffle([...Array(64).keys()].map(x=>x+1));
  let current = 1;

  createButtons(numbers,(n,b)=>{
    if(current===1 && !startTime) startTimer();
    if(n===current){ b.disabled=true; b.style.background="#8f8"; current++;
      if(current>64){ stopTimer(); result.textContent=`‚úÖ Fertig in ${((Date.now()-startTime)/1000).toFixed(2)}s`; nextBtn.style.display="inline-block"; }
    } else { b.style.background="#f88"; }
  });
}

// ---------- STUFE 1 ----------
function stage1() {
  stageTitle.textContent="Stufe 1 ‚Äì Zahlen 41‚Äì64 wegklicken";
  info.textContent="Klicke 41‚Äì64, danach 1‚Äì40 in Farbenchaos-Spiel.";
  result.textContent=""; timerDisplay.textContent="0.0"; nextBtn.style.display="none"; startTime=null;

  let numbers = shuffle([...Array(64).keys()].map(x=>x+1));
  let removed=0;

  createButtons(numbers,(n,b)=>{
    if(n>=41){ b.disabled=true; b.style.background="#f88"; removed++; if(removed===24) stage1_ordered(); }
  });
}

function stage1_ordered() {
  stageTitle.textContent="Stufe 1 ‚Äì Zahlen 1‚Äì40 Reihenfolge";
  info.textContent="Klicke 1‚Äì40 in richtiger Reihenfolge.";
  result.textContent=""; timerDisplay.textContent="0.0"; startTime=null;

  let numbers = shuffle([...Array(40).keys()].map(x=>x+1));
  let current=1;

  createButtons(numbers,(n,b)=>{
    if(current===1 && !startTime) startTimer();
    if(n===current){ b.disabled=true; b.style.background="#8f8"; current++;
      if(current>40){ stopTimer(); result.textContent=`‚úÖ Fertig in ${((Date.now()-startTime)/1000).toFixed(2)}s`; nextBtn.style.display="inline-block"; }
    } else { b.style.background="#f88"; }
  });
}

// ---------- STUFE 2 ----------
function stage2() {
  stageTitle.textContent="Stufe 2 ‚Äì Gruppierungen";
  info.textContent="Klicke 1‚Äì40 nach Gruppen in Ecken (1‚Äì9,10‚Äì19,20‚Äì29,30‚Äì40).";
  grid.className="stage2"; result.textContent=""; timerDisplay.textContent="0.0"; startTime=null; nextBtn.style.display="none";

  let numbers = shuffle([...Array(40).keys()].map(x=>x+1));
  let current=1;

  createButtons(numbers,(n,b)=>{
    if(current===1 && !startTime) startTimer();
    b.style.color = ["#ff6961","#f8d66d","#77dd77","#779ecb"][Math.floor((n-1)/10)];
    if(n===current){ b.disabled=true; b.style.background="#8f8"; current++;
      if(current>40){ stopTimer(); result.textContent=`‚úÖ Fertig in ${((Date.now()-startTime)/1000).toFixed(2)}s`; nextBtn.style.display="inline-block"; }
    } else { b.style.background="#f88"; }
  });
}

// ---------- STUFE 3 ----------
function stage3() {
  stageTitle.textContent="Stufe 3 ‚Äì S√§uberung";
  info.textContent="Klicke 'S√§ubern', dann Farbenchaos-Spiel erneut.";
  grid.className=""; result.textContent=""; timerDisplay.textContent="0.0"; startTime=null; nextBtn.style.display="none"; cleanBtn.style.display="inline-block";

  let numbers = shuffle([...Array(40).keys()].map(x=>x+1));
  createButtons(numbers,(n,b)=>{}); // nur anzeigen

  cleanBtn.onclick=()=>{
    cleanBtn.style.display="none";
    for(let b of grid.children){ b.style.color="#000"; b.disabled=false; b.style.background="white"; }
    let current=1; startTime=null; timerDisplay.textContent="0.0";
    for(let b of grid.children){
      b.onclick=()=>{
        if(current===1 && !startTime) startTimer();
        if(parseInt(b.textContent)===current){ b.disabled=true; b.style.background="#8f8"; current++;
          if(current>40){ stopTimer(); result.textContent=`‚úÖ Fertig in ${((Date.now()-startTime)/1000).toFixed(2)}s`; nextBtn.style.display="inline-block"; }
        } else { b.style.background="#f88"; }
      }
    }
  };
}

// ---------- STUFE 4 ----------
function stage4() {
  stageTitle.textContent="Stufe 4 ‚Äì Ordnen & Finale";
  info.textContent="Klicke 'Ordnen', danach letzte Reihenfolge-Spiel mit allen Zahlen.";
  grid.className=""; result.textContent=""; timerDisplay.textContent="0.0"; startTime=null;
  nextBtn.style.display="none"; sortBtn.style.display="inline-block";

  // Initial durcheinander, aber schwarz
  let numbers = [...Array(40).keys()].map(x=>x+1);
  numbers = shuffle(numbers);
  grid.innerHTML="";
  numbers.forEach(n=>{
    const b = document.createElement("button");
    b.textContent = n;
    b.style.color="#000"; b.style.background="white"; b.disabled=false;
    grid.appendChild(b);
  });

  sortBtn.onclick=()=>{
    sortBtn.style.display="none";
    let orderedNumbers = [...Array(40).keys()].map(x=>x+1);
    grid.innerHTML="";
    orderedNumbers.forEach(n=>{
      const b = document.createElement("button");
      b.textContent = n;
      b.style.color="#000"; b.style.background="white"; b.disabled=false;
      grid.appendChild(b);
    });

    // Reihenfolge-Spiel starten
    let current = 1; startTime=null; timerDisplay.textContent="0.0";
    for(let b of grid.children){
      b.onclick=()=>{
        if(current===1 && !startTime) startTimer();
        if(parseInt(b.textContent)===current){
          b.disabled=true; b.style.background="#8f8"; current++;
          if(current>40){ stopTimer(); result.textContent=`‚úÖ Finale Spiel abgeschlossen in ${((Date.now()-startTime)/1000).toFixed(2)}s`; nextBtn.style.display="inline-block"; }
        } else { b.style.background="#f88"; }
      }
    }
  };
}

// ---------- Steuerung ----------
nextBtn.onclick=()=>{
  stage++;
  if(stage===1) stage1();
  else if(stage===2) stage2();
  else if(stage===3) stage3();
  else if(stage===4) stage4();
  else{ stage=0; stage0(); }
};

// Start
stage0();
</script>

</body>
</html>
